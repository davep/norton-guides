





<!DOCTYPE html>
<html lang="en">

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.5.1 (ngdb v1.2.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-3715570.html">
    <link rel="next" href="rbint-3719987.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="../index.html">Guides</a></li>


          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-3715570.html">Previous</a></li>


          

<li><a href="rbint-3693080.html">Up</a></li>


          

<li><a href="rbint-3719987.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <div id="body">

      
        <nav class="menu box">
          <ul>
              <li>Lists</li>
              <li>
                <ul>
                  <li><a href="index.html">Comments</a></li>
                  <li><a href="rbint-7995.html">Interrupts</a></li>
                  <li><a href="rbint-15401.html">Glossary</a></li>
                  <li><a href="rbint-64347.html">Memory</a></li>
                  <li><a href="rbint-180090.html">CMOS</a></li>
                  <li><a href="rbint-250757.html">86 Bugs</a></li>
                  
                </ul>
              </li>
          </ul>
        </nav>
      

      <div id="entry" class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br><span class="line"><span class="ngu">Int 2F Fn 1605  - Ms Windows - Windows Enhanced Mode &amp; 286 Dosx Init Broa</span>  [<span class="ngb">W</span>]</span><br><span class="line"></span><br><span class="line">   AX = 1605h</span><br><span class="line">   ES:BX = 0000h:0000h</span><br><span class="line">   DS:SI = 0000h:0000h</span><br><span class="line">   CX = 0000h</span><br><span class="line">   DX = flags</span><br><span class="line">       bit 0 = 0 if Windows enhanced-mode initialization</span><br><span class="line">       bit 0 = 1 if Microsoft 286 DOS extender initialization</span><br><span class="line">       bits 1-15 reserved (undefined)</span><br><span class="line">   DI = version number (major in upper byte, minor in lower)</span><br><span class="line"></span><br><span class="line"><span class="ngb">Return:</span> CX = 0000h if okay for Windows to load</span><br><span class="line">   CX = FFFFh (other registers unchanged) if Windows 3.0 in standard mode</span><br><span class="line">   CX &lt;&gt; 0 if Windows should not load</span><br><span class="line">   ES:BX -&gt; startup info structure (see #2318)</span><br><span class="line">   DS:SI -&gt; virtual86 mode enable/disable callback or 0000h:0000h</span><br><span class="line">         (see #2321)</span><br><span class="line"></span><br><span class="line"><span class="ngb">Notes:</span> the Windows enhanced mode loader and Microsoft 286 DOS extender will</span><br><span class="line">     broadcast an INT 2F/AX=1605h call when initializing.  Any DOS device</span><br><span class="line">     driver or TSR can watch for this broadcast and return the appropriate</span><br><span class="line">     values.  If the driver or TSR returns CX &lt;&gt; 0, it is also its</span><br><span class="line">     responsibility to display an error message (however, Windows95 is</span><br><span class="line">     reported to load regardless of the returned CX).</span><br><span class="line">   each handler must first chain to the prior INT 2F handler with</span><br><span class="line">     registers unchanged before processing the call</span><br><span class="line">   if the handler requires local data on a per-VM basis, it must store the</span><br><span class="line">     returned ES:BX in the &#34;next&#34; field of a startup info structure and</span><br><span class="line">     return a pointer to that structure in ES:BX</span><br><span class="line">   a single TSR may set the V86 mode enable/disable callback; if DS:SI is</span><br><span class="line">     already nonzero, the TSR must fail the initialization by setting CX</span><br><span class="line">     nonzero</span><br><span class="line">   MSD checks for Windows 3.0 running in standard mode by testing whether</span><br><span class="line">     CX=FFFFh and other registers are unchanged on return</span><br><span class="line">   Novell DOS v7.0 (Update 8 - Update 11) TASKMGR in multitasking mode</span><br><span class="line">     uses this broadcast, even if TASKMGR.INI sets WinPresent= to OFF</span><br><span class="line">   Microsoft&#39;s EMM386.EXE for DOS 5+ when installed with the NOEMS option</span><br><span class="line">     changes its driver name from EMMQXXX0 to EMMXXXX0 while Windows is</span><br><span class="line">     active</span><br><span class="line"></span><br><span class="line"><span class="ngb">See Also:</span> AX=1606h,AX=1608h,AX=4B05h</span><br><span class="line"></span><br><span class="line">Format of Windows Startup Information Structure:</span><br><span class="line">Offset Size    Description (Table 2318)</span><br><span class="line"> 00h  2 BYTEs  major, minor version of info structure</span><br><span class="line"> 02h   DWORD   pointer to next startup info structure or 0000h:0000h</span><br><span class="line"> 06h   DWORD   pointer to ASCIZ name of virtual device file or 0000h:0000h</span><br><span class="line"> 0Ah   DWORD   virtual device reference data (see #2320)</span><br><span class="line">       (only used if above nonzero)</span><br><span class="line"> 0Eh   DWORD   pointer to instance data records (see #2319) or 0000h:0000h</span><br><span class="line"></span><br><span class="line">Format of one Instance Item in array:</span><br><span class="line">Offset Size    Description (Table 2319)</span><br><span class="line"> 00h   DWORD   address of instance data (end of array if 0000h:0000h)</span><br><span class="line"> 04h   WORD    size of instance data</span><br><span class="line"></span><br><span class="line">Format of Virtual Device Reference Data:</span><br><span class="line">Offset Size    Description (Table 2320)</span><br><span class="line"> 00h   DWORD   physical address of ??? or 00000000h</span><br><span class="line"> 04h   DWORD   physical address of ??? table</span><br><span class="line"> 08h   DWORD   &#34;DEST_PAGE&#34; address to which pages must be mapped</span><br><span class="line"> 0Ch  N DWORDs &#34;SRC_PAGE&#34; physical addresses of the pages</span><br><span class="line">       00000000h = end of table</span><br><span class="line"></span><br><span class="line"><span class="ngb">Note:</span>  EMM386.EXE sets the first pointer to the start of the device driver</span><br><span class="line">     chain, the second pointer to a field of 40h bytes followed by a</span><br><span class="line">     16-bit offset to the end of the SRC_PAGE table, and DEST_PAGE to</span><br><span class="line">     the start segment of the UMB area</span><br><span class="line"></span><br><span class="line">(Table 2321)</span><br><span class="line">Values Windows virtual mode enable/disable procedure is called with:</span><br><span class="line">   AX = 0000h disable V86 mode</span><br><span class="line">   AX = 0001h enable V86 mode</span><br><span class="line">   interrupts disabled</span><br><span class="line"></span><br><span class="line"><span class="ngb">Return:</span> CF set on error</span><br><span class="line">   CF clear if successful</span><br><span class="line">   interrupts disabled</span><br></pre>
  
  
  


      </div>

    </div>

    
      <footer>
        <nav class="box">
          <dl>
            <dt>Generated</dt><dd>2025-12-13 13:34:52</dd>
            <dt>Generator</dt><dd><a href="https://ng2web.davep.dev">ng2web v1.5.1 (ngdb v1.2.0)</a></dd>
          </dl>
        </nav>
      </footer>
    

  </body>

</html>

