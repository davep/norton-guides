





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-4005278.html">
    <link rel="next" href="rbint-4008992.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-4005278.html">Previous</a></li>


          

<li><a href="rbint-3870311.html">Up</a></li>


          

<li><a href="rbint-4008992.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Lists</li>
            <ul>
              <li><a href="index.html">Comments</a></li>
              <li><a href="rbint-7995.html">Interrupts</a></li>
              <li><a href="rbint-15401.html">Glossary</a></li>
              <li><a href="rbint-64347.html">Memory</a></li>
              <li><a href="rbint-180090.html">CMOS</a></li>
              <li><a href="rbint-250757.html">86 Bugs</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br /><span class="line"><span class="ngu">Int 2F Fn 4B01  C - Dos 5+ Task Switcher - Build Callout Chain           </span>  [<span class="ngb">T</span>]</span><br /><span class="line"></span><br /><span class="line">   AX = 4B01h</span><br /><span class="line">   CX:DX -&gt; task switcher entry point (see #2505)</span><br /><span class="line">   ES:BX = 0000h:0000h</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> ES:BX -&gt; callback info structure (see #2503) or 0000h:0000h</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> called by the task switcher</span><br /><span class="line">   this function is hooked by clients which require notification of task</span><br /><span class="line">     switcher activities; the call must first be passed on to the prior</span><br /><span class="line">     handler with registers unchanged using a simulated interrupt.  On</span><br /><span class="line">     return, the client must build a callback info structure and store</span><br /><span class="line">     the returned ES:BX in the &#34;next&#34; field, then return the address of</span><br /><span class="line">     its own callback info structure.</span><br /><span class="line">   a client program must add itself to the notification chain if it</span><br /><span class="line">     provides services to other programs; before terminating, it must</span><br /><span class="line">     remove itself from the chain by calling the task switcher&#39;s entry</span><br /><span class="line">     point with AX=0005h (see #2505)</span><br /><span class="line">   the task switcher entry point should not be saved, as it is subject to</span><br /><span class="line">     change and will be provided on any notification call</span><br /><span class="line">   the Windows 3.1 Standard Mode supports this API</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> AX=160Bh,AX=4B02h</span><br /><span class="line"></span><br /><span class="line">Format of task switcher callback info structure:</span><br /><span class="line">Offset Size    Description (Table 2503)</span><br /><span class="line"> 00h   DWORD   pointer to next callback info structure</span><br /><span class="line"> 04h   DWORD   pointer to notification function (see #2504)</span><br /><span class="line"> 08h   DWORD   reserved</span><br /><span class="line"> 0Ch   DWORD   address of zero-terminated list of API info structures</span><br /><span class="line">       (see #2507)</span><br /><span class="line"></span><br /><span class="line">(Table 2504)</span><br /><span class="line">Values task switcher notification function is called with:</span><br /><span class="line">   AX = function</span><br /><span class="line">       0000h switcher initialization</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = status</span><br /><span class="line">               0000h if OK to load</span><br /><span class="line">               nonzero to abort task switcher</span><br /><span class="line">       0001h query suspend</span><br /><span class="line">       BX = session ID</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = status</span><br /><span class="line">               0000h if OK to switch session</span><br /><span class="line">               0001h if not</span><br /><span class="line">       0002h suspend session</span><br /><span class="line">       BX = session ID</span><br /><span class="line">       interrupts disabled</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h if OK to switch session</span><br /><span class="line">              = 0001h if not</span><br /><span class="line">       0003h activate session</span><br /><span class="line">       BX = session ID</span><br /><span class="line">       CX = session status flags</span><br /><span class="line">           bit 0: set if first activation of session</span><br /><span class="line">           bits 1-15: reserved (0)</span><br /><span class="line">       interrupts disabled</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h</span><br /><span class="line">       0004h session active</span><br /><span class="line">       BX = session ID</span><br /><span class="line">       CX = session status flags</span><br /><span class="line">           bit 0: set if first activation of session</span><br /><span class="line">           bits 1-15: reserved (0)</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h</span><br /><span class="line">       0005h create session</span><br /><span class="line">       BX = session ID</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h if OK to create session</span><br /><span class="line">              = 0001h if not</span><br /><span class="line">       0006h destroy session</span><br /><span class="line">       BX = session ID</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h</span><br /><span class="line">       0007h switcher termination</span><br /><span class="line">       BX = flags</span><br /><span class="line">           bit 0: set if calling switcher is only switcher loaded</span><br /><span class="line">           bits 1-15: reserved (0)</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Return:</span> AX = 0000h</span><br /><span class="line">   ES:DI -&gt; task switcher entry point (see #2505)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> function 0000h is generally called by the program which controls or</span><br /><span class="line">     invokes the task switcher, rather than by the task switcher itself;</span><br /><span class="line">     the entry point supplied to this function is not necessarily the</span><br /><span class="line">     entry point to the task switcher itself, and may be 0000h:0000h.  If</span><br /><span class="line">     any client indicates that loading is not possible, all clients will</span><br /><span class="line">     be called with function 0007h; thus it is possible for a client to</span><br /><span class="line">     receive a termination notice without a corresponding initialization</span><br /><span class="line">     notice.</span><br /><span class="line">   except for functions 0002h and 0003h, the notification handler is</span><br /><span class="line">     called with interrupts enabled and may make any INT 21h function</span><br /><span class="line">     call; interrupts must not be enabled in functions 0002h and 0003h</span><br /><span class="line">   function 0007h may be called with ES:DI = 0000h:0000h if the entry</span><br /><span class="line">     point is no longer valid</span><br /></pre>
  
  
  


      </article>

    </section>

  </body>

</html>

