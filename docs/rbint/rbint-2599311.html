





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-2598354.html">
    <link rel="next" href="rbint-2609597.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="../index.html">Guides</a></li>


          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-2598354.html">Previous</a></li>


          

<li><a href="rbint-2471063.html">Up</a></li>


          

<li><a href="rbint-2609597.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Lists</li>
            <ul>
              <li><a href="index.html">Comments</a></li>
              <li><a href="rbint-7995.html">Interrupts</a></li>
              <li><a href="rbint-15401.html">Glossary</a></li>
              <li><a href="rbint-64347.html">Memory</a></li>
              <li><a href="rbint-180090.html">CMOS</a></li>
              <li><a href="rbint-250757.html">86 Bugs</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br /><span class="line"><span class="ngu">Int 21 Fn 5D0B  OU - Dos 4.x Only Internal - Get Dos Swappable Data Areas</span>  [<span class="ngb">D</span>]</span><br /><span class="line"></span><br /><span class="line">   AX = 5D0Bh</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> CF set on error</span><br /><span class="line">       AX = error code (see #1366)</span><br /><span class="line">   CF clear if successful</span><br /><span class="line">       DS:SI -&gt; swappable data area list (see #1375)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> copying and restoring the swappable data areas allows DOS to be</span><br /><span class="line">     reentered unless it is in a critical section delimited by calls to</span><br /><span class="line">     INT 2A/AH=80h and INT 2A/AH=81h,82h</span><br /><span class="line">   SHARE and other DOS utilities consult the byte at offset 04h in the</span><br /><span class="line">     DOS data segment (see INT 2F/AX=1203h) to determine the SDA format</span><br /><span class="line">     in use: 00h = DOS 3.x, 01h = DOS 4.0-6.0, other = error.</span><br /><span class="line">   DOS 5+ use the SDA format listed below, but revert back to the DOS 3.x</span><br /><span class="line">     call for finding the SDA (see #1373); Novell DOS 7 does not support</span><br /><span class="line">     this function, either.</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> AX=5D06h,INT 2A/AH=80h,INT 2A/AH=81h,INT 2A/AH=82h,INT 2F/AX=1203h</span><br /><span class="line"></span><br /><span class="line">Format of DOS 4.x swappable data area list:</span><br /><span class="line">Offset Size    Description (Table 1375)</span><br /><span class="line"> 00h   WORD    count of data areas</span><br /><span class="line"> 02h  N BYTEs  &#34;count&#34; copies of data area record</span><br /><span class="line">       Offset  Size    Description</span><br /><span class="line">        00h    DWORD   address</span><br /><span class="line">        04h    WORD    length and type</span><br /><span class="line">               bit 15 set if swap always, clear if swap in DOS</span><br /><span class="line">               bits 14-0: length in bytes</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1376</span><br /><span class="line"></span><br /><span class="line">Format of DOS 4.0-6.0 swappable data area:</span><br /><span class="line">Offset Size    Description (Table 1376)</span><br /><span class="line"> -34   BYTE    printer echo flag (00h off, FFh active)</span><br /><span class="line"> -31   BYTE    current switch character (ignored by DOS 5+)</span><br /><span class="line"> -30   BYTE    current memory allocation strategy (see AH=58h)</span><br /><span class="line"> -28   BYTE    incremented on each INT 21/AX=5E01h call</span><br /><span class="line"> -27 16 BYTEs  machine name set by INT 21/AX=5E01h</span><br /><span class="line"> -11  5 WORDs  zero-terminated list of offsets which need to be patched to</span><br /><span class="line">         enable critical-section calls (see INT 2A/AH=80h)</span><br /><span class="line">       (all offsets are 0D0Ch, but this list is still present for</span><br /><span class="line">         DOS 3.x compatibility)</span><br /><span class="line"> -1    BYTE    unused padding</span><br /><span class="line">---start of actual SDA---</span><br /><span class="line"> 00h   BYTE    critical error flag (&#34;ErrorMode&#34;)</span><br /><span class="line"> 01h   BYTE    InDOS flag (count of active INT 21 calls)</span><br /><span class="line"> 02h   BYTE    drive on which current critical error occurred or FFh</span><br /><span class="line">       (DR DOS 3.41/5.0 set this to 00h when no critical error)</span><br /><span class="line"> 03h   BYTE    locus of last error</span><br /><span class="line"> 04h   WORD    extended error code of last error</span><br /><span class="line"> 06h   BYTE    suggested action for last error</span><br /><span class="line"> 07h   BYTE    class of last error</span><br /><span class="line"> 08h   DWORD   ES:DI pointer for last error</span><br /><span class="line"> 0Ch   DWORD   current DTA (Disk Transfer Address)</span><br /><span class="line">       note: may point into SDA during the DOS EXEC function</span><br /><span class="line">         (see AH=4Bh), so programs which swap the SDA must be</span><br /><span class="line">         prepared to move the DTA to a private buffer if they</span><br /><span class="line">         might be invoked during an EXEC</span><br /><span class="line"> 10h   WORD    current PSP</span><br /><span class="line"> 12h   WORD    stores SP across an INT 23</span><br /><span class="line"> 14h   WORD    return code from last process termination (zerod after reading</span><br /><span class="line">         with AH=4Dh)</span><br /><span class="line"> 16h   BYTE    current drive</span><br /><span class="line"> 17h   BYTE    extended break flag</span><br /><span class="line"> 18h   BYTE    flag: code page switching</span><br /><span class="line"> 19h   BYTE    flag: copy of previous byte in case of INT 24 Abort</span><br /><span class="line">---remainder need only be swapped if in DOS---</span><br /><span class="line"> 1Ah   WORD    value of AX on call to INT 21</span><br /><span class="line"> 1Ch   WORD    PSP segment for sharing/network</span><br /><span class="line"> 1Eh   WORD    network machine number for sharing/network (0000h = us)</span><br /><span class="line"> 20h   WORD    first usable memory block found when allocating memory</span><br /><span class="line"> 22h   WORD    best usable memory block found when allocating memory</span><br /><span class="line"> 24h   WORD    last usable memory block found when allocating memory</span><br /><span class="line"> 26h   WORD    memory size in paragraphs (used only during initialization)</span><br /><span class="line"> 28h   WORD    last entry checked during directory search</span><br /><span class="line"> 2Ah   BYTE    flag: nonzero if INT 24 Fail</span><br /><span class="line"> 2Bh   BYTE    flags: allowable INT 24 responses (passed to INT 24 in AH)</span><br /><span class="line"> 2Ch   BYTE    flag: do not set directory if nonzero</span><br /><span class="line"> 2Dh   BYTE    flag: program aborted by ^C</span><br /><span class="line"> 2Eh   BYTE    flag: allow embedded blanks in FCB</span><br /><span class="line">       may also allow use of &#34;*&#34; wildcard in FCBs</span><br /><span class="line"> 2Fh   BYTE    padding (unused)</span><br /><span class="line"> 30h   BYTE    day of month</span><br /><span class="line"> 31h   BYTE    month</span><br /><span class="line"> 32h   WORD    year - 1980</span><br /><span class="line"> 34h   WORD    number of days since 01jan1980</span><br /><span class="line"> 36h   BYTE    day of week (0 = Sunday)</span><br /><span class="line"> 37h   BYTE    flag: console swapped during read from device</span><br /><span class="line"> 38h   BYTE    flag: safe to call INT 28 if nonzero</span><br /><span class="line"> 39h   BYTE    flag: abort currently in progress, turn INT 24 Abort into Fail</span><br /><span class="line"> 3Ah 30 BYTEs  device driver request header (see #2284 at INT 2F/AX=0802h) for</span><br /><span class="line">         device calls</span><br /><span class="line"> 58h   DWORD   pointer to device driver entry point (used in calling driver)</span><br /><span class="line"> 5Ch 22 BYTEs  device driver request header for I/O calls</span><br /><span class="line"> 72h 14 BYTEs  device driver request header for disk status check</span><br /><span class="line"> 80h   DWORD   pointer to device I/O buffer</span><br /><span class="line"> 84h   WORD    ???</span><br /><span class="line"> 86h   WORD    ??? (0)</span><br /><span class="line"> 88h   BYTE    type of PSP copy (00h=simple for INT 21/AH=26h, FFh=make child)</span><br /><span class="line"> 89h   DWORD   start offset of file region to lock/unlock</span><br /><span class="line"> 8Dh   DWORD   length of file region to lock/unlock</span><br /><span class="line"> 91h   BYTE    padding (unused)</span><br /><span class="line"> 92h  3 BYTEs  24-bit user number (see AH=30h)</span><br /><span class="line"> 95h   BYTE    OEM number (see #1082 at AH=30h)</span><br /><span class="line"> 96h  6 BYTEs  CLOCK$ transfer record (see #1374 at AX=5D06h)</span><br /><span class="line"> 9Ch   BYTE    device I/O buffer for single-byte I/O functions</span><br /><span class="line"> 9Dh   BYTE    padding???</span><br /><span class="line"> 9Eh 128 BYTEs buffer for filename</span><br /><span class="line">11Eh 128 BYTEs buffer for filename</span><br /><span class="line">19Eh 21 BYTEs  findfirst/findnext search data block (see #1312 at AH=4Eh)</span><br /><span class="line">1B3h 32 BYTEs  directory entry for found file (see #1082 at AH=11h)</span><br /><span class="line">1D3h 88 BYTEs  copy of current directory structure for drive being accessed</span><br /><span class="line">22Bh 11 BYTEs  FCB-format filename for device name comparison</span><br /><span class="line">236h   BYTE    terminating NUL for above filename</span><br /><span class="line">237h 11 BYTEs  wildcard destination specification for rename (FCB format)</span><br /><span class="line">242h   BYTE    terminating NUL for above filespec</span><br /><span class="line">243h   BYTE    ???</span><br /><span class="line">244h   WORD    ???</span><br /><span class="line">246h  5 BYTEs  ???</span><br /><span class="line">24Bh   BYTE    extended FCB file attributes</span><br /><span class="line">24Ch   BYTE    type of FCB (00h regular, FFh extended)</span><br /><span class="line">24Dh   BYTE    directory search attributes</span><br /><span class="line">24Eh   BYTE    file open/access mode</span><br /><span class="line">24Fh   BYTE    ??? flag bits</span><br /><span class="line">       reportedly 00h when deleting a file under MSDOS 5.0</span><br /><span class="line">250h   BYTE    flag: device name found on rename, or file not found</span><br /><span class="line">251h   BYTE    splice flag??? (file name and directory name together)</span><br /><span class="line">252h   BYTE    flag indicating how DOS function was invoked</span><br /><span class="line">       (00h = direct INT 20/INT 21, FFh = server call AX=5D00h)</span><br /><span class="line">253h   BYTE    sector position within cluster</span><br /><span class="line">254h   BYTE    ??? (flag: translate sector/cluster)</span><br /><span class="line">255h   BYTE    ??? (flag: 00h if read, 01h if write)</span><br /><span class="line">256h   BYTE    current working drive number</span><br /><span class="line">257h   BYTE    cluster factor</span><br /><span class="line">258h   BYTE    ???</span><br /><span class="line">259h   BYTE    line edit (AH=0Ah) insert mode flag (nonzero = on)</span><br /><span class="line">25Ah   BYTE    canonicalized filename referred to existing file/dir if FFh</span><br /><span class="line">25Bh   BYTE    volume ID flag</span><br /><span class="line">25Ch   BYTE    type of process termination (00h-03h) (see AH=4Dh)</span><br /><span class="line">25Dh   BYTE    ???</span><br /><span class="line">25Eh   BYTE    ??? file create flag (00h = no, search only)</span><br /><span class="line">25Fh   BYTE    ??? (value for deleted file&#39;s first byte)</span><br /><span class="line">260h   DWORD   pointer to Drive Parameter Block for critical error invocation</span><br /><span class="line">264h   DWORD   pointer to stack frame containing user registers on INT 21</span><br /><span class="line">268h   WORD    stores SP across INT 24</span><br /><span class="line">26Ah   DWORD   pointer to DOS Drive Parameter Block for ???</span><br /><span class="line">26Eh   WORD    segment of disk buffer</span><br /><span class="line">270h   WORD    ??? (saving partial cluster number)</span><br /><span class="line">272h   WORD    ??? (temp: sector of work current cluster)</span><br /><span class="line">274h   WORD    ??? (high part of cluster number)</span><br /><span class="line">276h   WORD    ??? (temp)</span><br /><span class="line">278h   BYTE    Media ID byte returned by AH=1Bh,1Ch</span><br /><span class="line">279h   BYTE    ??? (doesn&#39;t seem to be referenced)</span><br /><span class="line">27Ah   DWORD   pointer to device header if filename is character device</span><br /><span class="line">27Eh   DWORD   pointer to current SFT</span><br /><span class="line">282h   DWORD   pointer to current directory structure for drive being accessed</span><br /><span class="line">286h   DWORD   pointer to caller&#39;s FCB</span><br /><span class="line">28Ah   WORD    SFT index to which file being opened will refer</span><br /><span class="line">28Ch   WORD    temporary storage for file handle</span><br /><span class="line">28Eh   DWORD   pointer to a JFT entry in process handle table</span><br /><span class="line">         (see #1066 at AH=26h)</span><br /><span class="line">292h   WORD    offset in DOS DS of first filename argument</span><br /><span class="line">294h   WORD    offset in DOS DS of second filename argument</span><br /><span class="line">296h   WORD    ??? (offset of last component in pathname or FFFFh)</span><br /><span class="line">298h   WORD    offset of transfer address to add</span><br /><span class="line">29Ah   WORD    last relative cluster within file being accessed</span><br /><span class="line">29Ch   WORD    temp: absolute cluster number being accessed</span><br /><span class="line">29Eh   WORD    directory sector number</span><br /><span class="line">2A0h   WORD    ???</span><br /><span class="line">2A2h   WORD    ??? directory cluster number</span><br /><span class="line">2A4h   DWORD   current relative sector number within file</span><br /><span class="line">2A8h   DWORD   ??? (current sector number)</span><br /><span class="line">2ACh   WORD    ??? (current byte offset within sector)</span><br /><span class="line">2AEh   DWORD   current offset in file</span><br /><span class="line">2B2h   WORD    ???</span><br /><span class="line">2B4h   WORD    bytes in partial sector</span><br /><span class="line">2B6h   WORD    number of sectors</span><br /><span class="line">2B8h   WORD    ??? (free file cluster entry)</span><br /><span class="line">2BAh   WORD    ??? (last file cluster entry)</span><br /><span class="line">2BCh   WORD    ??? (next file cluster number)</span><br /><span class="line">2BEh   DWORD   number of bytes appended to file</span><br /><span class="line">2C2h   DWORD   pointer to current work disk buffer</span><br /><span class="line">2C6h   DWORD   pointer to working SFT</span><br /><span class="line">2CAh   WORD    used by INT 21 dispatcher to store caller&#39;s BX</span><br /><span class="line">2CCh   WORD    used by INT 21 dispatcher to store caller&#39;s DS</span><br /><span class="line">2CEh   WORD    temporary storage while saving/restoring caller&#39;s registers</span><br /><span class="line">2D0h   DWORD   pointer to prev call frame (offset 264h) if INT 21 reentered</span><br /><span class="line">       also switched to for duration of INT 24</span><br /><span class="line">2D4h   WORD    open mode/action for INT 21/AX=6C00h</span><br /><span class="line">2D6h   BYTE    ??? (set to 00h by INT 21h dispatcher, 02h when a read is</span><br /><span class="line">         performed, and 01h or 03h by INT 21/AX=6C00h)</span><br /><span class="line">2D7h   WORD    ??? apparently unused</span><br /><span class="line">2D9h   DWORD   stored ES:DI for AX=6C00h</span><br /><span class="line">2DDh   WORD    extended file open action code (see #1459 at AX=6C00h)</span><br /><span class="line">2DFh   WORD    extended file open attributes (see #1458 at AX=6C00h)</span><br /><span class="line">2E1h   WORD    extended file open file mode (see AX=6C00h)</span><br /><span class="line">2E3h   DWORD   pointer to filename to open (see AX=6C00h)</span><br /><span class="line">2E7h   WORD    ??? temp DX storage or 0000h or temp data buffer size from</span><br /><span class="line">         disk buffer</span><br /><span class="line">2E9h   WORD    ???</span><br /><span class="line">2EBh   BYTE    ???</span><br /><span class="line">2ECh   WORD    stores DS during call to [List-of-Lists + 37h]</span><br /><span class="line">2EEh   WORD    ???</span><br /><span class="line">2F0h   BYTE    ???</span><br /><span class="line">2F1h   WORD    ??? bit flags</span><br /><span class="line">2F3h   DWORD   pointer to user-supplied filename</span><br /><span class="line">2F7h   DWORD   pointer to ???</span><br /><span class="line">2FBh   WORD    stores SS during call to [List-of-Lists + 37h]</span><br /><span class="line">2FDh   WORD    stores SP during call to [List-of-Lists + 37h]</span><br /><span class="line">2FFh   BYTE    flag, nonzero if stack switched in calling [List-of-Lists+37h]</span><br /><span class="line">300h 21 BYTEs  FindFirst search data for source file(s) of a rename operation</span><br /><span class="line">       (see #1312 at AH=4Eh)</span><br /><span class="line">315h 32 BYTEs  directory entry for file being renamed (see #1041 at AH=11h)</span><br /><span class="line">335h 331 BYTEs critical error stack</span><br /><span class="line">480h 384 BYTEs disk stack (functions greater than 0Ch, INT 25,INT 26)</span><br /><span class="line">600h 384 BYTEs character I/O stack (functions 01h through 0Ch)</span><br /><span class="line">780h   BYTE    device driver lookahead flag (usually printer)</span><br /><span class="line">       (see AH=64h&#34;DOS 3.2+&#34;)</span><br /><span class="line">781h   BYTE    volume change flag</span><br /><span class="line">782h   BYTE    flag: virtual open</span><br /><span class="line">783h   BYTE    ???</span><br /><span class="line">784h   WORD    ???</span><br /><span class="line">786h   WORD    ???</span><br /><span class="line">788h   WORD    ???</span><br /><span class="line">78Ah   WORD    ???</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1373,#1375</span><br /></pre>
  
  
  


      </article>

    </section>

  </body>

</html>

