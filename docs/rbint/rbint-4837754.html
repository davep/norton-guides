





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-4836656.html">
    <link rel="next" href="rbint-4848045.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-4836656.html">Previous</a></li>


          

<li><a href="rbint-4836219.html">Up</a></li>


          

<li><a href="rbint-4848045.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Lists</li>
            <ul>
              <li><a href="index.html">Comments</a></li>
              <li><a href="rbint-7995.html">Interrupts</a></li>
              <li><a href="rbint-15401.html">Glossary</a></li>
              <li><a href="rbint-64347.html">Memory</a></li>
              <li><a href="rbint-180090.html">CMOS</a></li>
              <li><a href="rbint-250757.html">86 Bugs</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br /><span class="line"><span class="ngu">Int 4F Fn 8100  - Common Access Method Scsi Interface Rev 2.3 - Send Ccb </span>  [<span class="ngb">d</span>]</span><br /><span class="line"></span><br /><span class="line">   AX = 8100h</span><br /><span class="line">   ES:BX -&gt; CAM Control Block (CCB) (see #2900)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> AH = status</span><br /><span class="line">       00h successful</span><br /><span class="line">       01h invalid CCB address (0000h:0000h)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Note:</span>  the SCSI Interface Module (SIM) may complete the requested function</span><br /><span class="line">     and invoke the completion callback function before this call returns</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> AX=8200h,INT 2F/AX=7F01h,INT 4B&#34;Common Access Method&#34;</span><br /><span class="line"></span><br /><span class="line">(Table 2899)</span><br /><span class="line">Values for CAM function code:</span><br /><span class="line"> 00h   NOP</span><br /><span class="line"> 01h   execute SCSI I/O</span><br /><span class="line"> 02h   get device type</span><br /><span class="line"> 03h   path inquiry</span><br /><span class="line"> 04h   release SIM queue</span><br /><span class="line"> 05h   set async callback</span><br /><span class="line"> 06h   set device type</span><br /><span class="line"> 07h-0Fh reserved</span><br /><span class="line"> 10h   abort SCSI command</span><br /><span class="line"> 11h   reset SCSI bus</span><br /><span class="line"> 12h   reset SCSI device</span><br /><span class="line"> 13h   terminate I/O process</span><br /><span class="line"> 14h-1Fh reserved</span><br /><span class="line"> 20h   engine inquiry</span><br /><span class="line"> 21h   execute engine request</span><br /><span class="line"> 22h-2Fh reserved</span><br /><span class="line"> 30h   enable logical unit number</span><br /><span class="line"> 31h   execute target I/O</span><br /><span class="line"> 32h-7Fh reserved</span><br /><span class="line"> 80h-FFh vendor-specific functions</span><br /><span class="line"></span><br /><span class="line">Format of CAM Control Block:</span><br /><span class="line">Offset Size    Description (Table 2900)</span><br /><span class="line"> 00h   DWORD   physical address of this CCB</span><br /><span class="line"> 04h   WORD    CAM control block length</span><br /><span class="line"> 06h   BYTE    function code (see #2899)</span><br /><span class="line"> 07h   BYTE    CAM status (see #2903)</span><br /><span class="line"> 08h   BYTE    SCSI status</span><br /><span class="line"> 09h   BYTE    path ID (FFh = XPT)</span><br /><span class="line"> 0Ah   BYTE    target ID</span><br /><span class="line"> 0Bh   BYTE    logical unit number</span><br /><span class="line"> 0Ch   WORD    CAM flags (see #2901)</span><br /><span class="line"> 0Eh   BYTE    CAM address flags (see #2902)</span><br /><span class="line"> 0Fh   BYTE    target-mode flags (see #2904)</span><br /><span class="line">---function 02h---</span><br /><span class="line"> 10h   DWORD   pointer to 36-byte buffer for inquiry data or 0000h:0000h</span><br /><span class="line"> 14h   BYTE    peripheral device type of target logical unit number</span><br /><span class="line">---function 03h---</span><br /><span class="line"> 10h   BYTE    version number (00h-07h prior to rev 1.7, 08h = rev 1.7,</span><br /><span class="line">       09h-FFh = rev no, i.e. 23h = rev 2.3)</span><br /><span class="line"> 11h   BYTE    SCSI capabilities (see #2905)</span><br /><span class="line"> 12h   BYTE    target mode support</span><br /><span class="line">       bit 7: processor mode</span><br /><span class="line">       bit 6: phase-cognizant mode</span><br /><span class="line">       bit 5-0: reserved</span><br /><span class="line"> 13h   BYTE    miscellaneous flags</span><br /><span class="line">       bit 7: scanned high to low instead of low to high</span><br /><span class="line">       bit 6: removables not included in scan</span><br /><span class="line">       bit 5: inquiry data not kept by XPT</span><br /><span class="line">       bits 4-0: reserved</span><br /><span class="line"> 14h   WORD    engine count</span><br /><span class="line"> 16h 14 BYTEs  vendor-specific data</span><br /><span class="line"> 24h   DWORD   size of private data area</span><br /><span class="line"> 28h   DWORD   asynchronous event capabilities (see #2906)</span><br /><span class="line"> 2Ch   BYTE    highest path ID assigned</span><br /><span class="line"> 2Dh   BYTE    SCSI device ID of initiator</span><br /><span class="line"> 2Eh  2 BYTEs  reserved</span><br /><span class="line"> 30h 16 BYTEs  SIM vendor ID</span><br /><span class="line"> 40h 16 BYTEs  HBA (host bus adaptor) vendor ID</span><br /><span class="line"> 50h  4 BYTEs  operating-system dependant usage</span><br /><span class="line">---functions 00h,04h,11h,12h---</span><br /><span class="line"> no additional fields</span><br /><span class="line">---function 05h---</span><br /><span class="line"> 10h   DWORD   asynchronous event enables (refer to function 03h above)</span><br /><span class="line"> 14h   DWORD   pointer to asynchronous callback routine (see #2912)</span><br /><span class="line"> 18h   DWORD   pointer to peripheral driver buffer</span><br /><span class="line"> 1Ch   BYTE    size of peripheral buffer</span><br /><span class="line">---function 06h---</span><br /><span class="line"> 10h   BYTE    peripheral device type of target</span><br /><span class="line">---functions 10h,13h---</span><br /><span class="line"> 10h   DWORD   pointer to CCB to be aborted</span><br /><span class="line">---function 20h---</span><br /><span class="line"> 10h   WORD    engine number</span><br /><span class="line"> 12h   BYTE    engine type</span><br /><span class="line">       00h buffer memory</span><br /><span class="line">       01h lossless compression</span><br /><span class="line">       02h lossy compression</span><br /><span class="line">       03h encryption</span><br /><span class="line"> 13h   BYTE    engine algorithm ID</span><br /><span class="line">       00h vendor-unique</span><br /><span class="line">       01h LZ1 variation 1 (STAC)</span><br /><span class="line">       02h LZ2 variation 1 (HP DCZL)</span><br /><span class="line">       03h LZ2 variation 2 (Infochip)</span><br /><span class="line"> 14h   DWORD   engine memory size</span><br /><span class="line">---function 21h---</span><br /><span class="line"> 10h   DWORD   pointer to peripheral driver</span><br /><span class="line"> 14h  4 BYTEs  reserved</span><br /><span class="line"> 18h   DWORD   OS-dependent request-mapping info</span><br /><span class="line"> 1Ch   DWORD   address of completion callback routine</span><br /><span class="line"> 20h   DWORD   pointer to scatter/gather list or data buffer</span><br /><span class="line"> 24h   DWORD   length of data transfer</span><br /><span class="line"> 28h   DWORD   pointer to engine buffer data</span><br /><span class="line"> 2Ch  2 BYTEs  reserved</span><br /><span class="line"> 2Eh   WORD    number of scatter/gather entries</span><br /><span class="line"> 30h   DWORD   maximum destination data length</span><br /><span class="line"> 34h   DWORD   length of destination data</span><br /><span class="line"> 38h   DWORD   source residual length</span><br /><span class="line"> 3Ch 12 BYTEs  reserved</span><br /><span class="line"> 48h   DWORD   OS-dependent timeout value</span><br /><span class="line"> 4Ch  4 BYTEs  reserved</span><br /><span class="line"> 50h   WORD    engine number</span><br /><span class="line"> 52h   WORD    vendor-unique flags</span><br /><span class="line"> 54h  4 BYTEs  reserved</span><br /><span class="line"> 58h  N BYTEs  private data area for SIM</span><br /><span class="line">---function 30h---</span><br /><span class="line"> 10h   WORD    group 6 vendor-unique CDB length</span><br /><span class="line"> 12h   WORD    group 7 vendor-unique CDB length</span><br /><span class="line"> 14h   DWORD   pointer to target CCB list</span><br /><span class="line"> 18h   WORD    number of target CCBs</span><br /><span class="line">---other functions---</span><br /><span class="line"> 10h   DWORD   pointer to peripheral driver</span><br /><span class="line"> 14h   DWORD   pointer to next CCB</span><br /><span class="line"> 18h   DWORD   OS-dependent request mapping information</span><br /><span class="line"> 1Ch   DWORD   address of completion callback routine (see #2911)</span><br /><span class="line"> 20h   DWORD   pointer to scatter/gather list or data buffer</span><br /><span class="line"> 24h   DWORD   length of data transfer</span><br /><span class="line"> 28h   DWORD   pointer to sense info buffer</span><br /><span class="line"> 2Ch   BYTE    length of sense info buffer</span><br /><span class="line"> 2Dh   BYTE    CDB length</span><br /><span class="line"> 2Eh   WORD    number of scatter/gather entries</span><br /><span class="line">       scatter/gather list is array of 2N DWORDs, each pair specifying</span><br /><span class="line">         the address and length of a data block</span><br /><span class="line"> 30h  4 BYTEs  vendor-specific data</span><br /><span class="line"> 34h   BYTE    (ret) SCSI status</span><br /><span class="line"> 35h   BYTE    (ret) auto-sense residual length</span><br /><span class="line"> 36h  2 BYTEs  reserved</span><br /><span class="line"> 38h   DWORD   (ret) residual length</span><br /><span class="line"> 40h 12 BYTEs  Command Descriptor Block (CDB) (see #2907,#2908,#2909)</span><br /><span class="line"> 44h   DWORD   OS-dependent timeout value</span><br /><span class="line"> 48h   DWORD   pointer to message buffer</span><br /><span class="line"> 4Ch   WORD    length of message buffer</span><br /><span class="line"> 4Eh   WORD    vendor-unique flags</span><br /><span class="line"> 50h   BYTE    tag queue action</span><br /><span class="line"> 51h  3 BYTEs  reserved</span><br /><span class="line"> 54h  N BYTEs  private data area for SIM</span><br /><span class="line"></span><br /><span class="line">Bitfields for CAM flags:</span><br /><span class="line">Bit(s) Description (Table 2901)</span><br /><span class="line"> 0 CDB is a pointer</span><br /><span class="line"> 1 tagged queue action enable</span><br /><span class="line"> 2 linked CDB</span><br /><span class="line"> 3 disable callback on completion</span><br /><span class="line"> 4 scatter/gather</span><br /><span class="line"> 5 disable autosense</span><br /><span class="line"> 7-6   direction (00 reserved, 01 in, 10 out, 11 no data transfer)</span><br /><span class="line"> 9-8   reserved</span><br /><span class="line"> 10    engine synchronize</span><br /><span class="line"> 11    SIM queue freeze</span><br /><span class="line"> 12    SIM queue priority</span><br /><span class="line">   1 head insertion</span><br /><span class="line">   0 tail insertion (normal)</span><br /><span class="line"> 13    disable synchronous transfers   \ mutually</span><br /><span class="line"> 14    initiate synchronous transfers  / exclusive</span><br /><span class="line"> 15    disable disconnect</span><br /><span class="line"></span><br /><span class="line">Bitfields for CAM address flags:</span><br /><span class="line">Bit(s) Description (Table 2902)</span><br /><span class="line"> 7 SG list/data (0 = host, 1 = engine)</span><br /><span class="line"> 6 CDB pointer    (6-1: 0=virtual addr, 1=phys addr)</span><br /><span class="line"> 5 SG list/data</span><br /><span class="line"> 4 sense buffer</span><br /><span class="line"> 3 message buffer</span><br /><span class="line"> 2 next CCB</span><br /><span class="line"> 1 callback on completion</span><br /><span class="line"> 0 reserved</span><br /><span class="line"></span><br /><span class="line">(Table 2903)</span><br /><span class="line">Values for CAM status:</span><br /><span class="line"> 00h   request in progress</span><br /><span class="line"> 01h   request successful</span><br /><span class="line"> 02h   host aborted request</span><br /><span class="line"> 03h   unable to abort request</span><br /><span class="line"> 04h   request completed with error</span><br /><span class="line"> 05h   CAM is busy</span><br /><span class="line"> 06h   invalid request</span><br /><span class="line"> 07h   invalid path ID</span><br /><span class="line"> 08h   no such SCSI device</span><br /><span class="line"> 09h   unable to terminate I/O process</span><br /><span class="line"> 0Ah   timeout on target selection</span><br /><span class="line"> 0Bh   timeout on command</span><br /><span class="line"> 0Dh   receive message rejection</span><br /><span class="line"> 0Eh   sent/received SCSI bus reset</span><br /><span class="line"> 0Fh   detected uncorrectable parity error</span><br /><span class="line"> 10h   Autosense request failed</span><br /><span class="line"> 11h   no HBA detected</span><br /><span class="line"> 12h   data over/underrun</span><br /><span class="line"> 13h   bus freed unexpectedly</span><br /><span class="line"> 14h   target bus phase sequence failure</span><br /><span class="line"> 15h   CCB too small</span><br /><span class="line"> 16h   requested capability not available</span><br /><span class="line"> 17h   sent bus device reset</span><br /><span class="line"> 18h   terminate I/O process</span><br /><span class="line"> 38h   invalid LUN</span><br /><span class="line"> 39h   invalid target ID</span><br /><span class="line"> 3Ah   unimplemented function</span><br /><span class="line"> 3Bh   nexus not established</span><br /><span class="line"> 3Ch   invalid initiator ID</span><br /><span class="line"> 3Dh   received SCSI Command Descriptor Block</span><br /><span class="line"> 3Eh   LUN already enabled</span><br /><span class="line"> 3Fh   SCSI bus busy</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Note:</span>  bit 6 set to indicate frozen SIM queue</span><br /><span class="line">   bit 7 set to indicate valid autosense</span><br /><span class="line"></span><br /><span class="line">Bitfields for CAM target-mode flags:</span><br /><span class="line">Bit(s) Description (Table 2904)</span><br /><span class="line"> 7 data buffer valid</span><br /><span class="line"> 6 status valid</span><br /><span class="line"> 5 message buffer valid</span><br /><span class="line"> 4 reserved</span><br /><span class="line"> 3 phase-cognizant mode</span><br /><span class="line"> 2 target CCB available</span><br /><span class="line"> 1 disable autodisconnect</span><br /><span class="line"> 0 disable autosave/restore</span><br /><span class="line"></span><br /><span class="line">Bitfields for SCSI capabilities:</span><br /><span class="line">Bit(s) Description (Table 2905)</span><br /><span class="line"> 7 modify data pointers</span><br /><span class="line"> 6 wide bus (32 bits)</span><br /><span class="line"> 5 wide bus (16 bits)</span><br /><span class="line"> 4 synchronous transfers</span><br /><span class="line"> 3 linked commands</span><br /><span class="line"> 2 reserved</span><br /><span class="line"> 1 tagged queueing</span><br /><span class="line"> 0 soft reset</span><br /><span class="line"></span><br /><span class="line">Bitfields for CAM asynchronous event capabilities:</span><br /><span class="line">Bit(s) Description (Table 2906)</span><br /><span class="line"> 31-24 vendor-specific</span><br /><span class="line"> 23-8  reserved</span><br /><span class="line"> 7 new devices found during rescan</span><br /><span class="line"> 6 SIM module deregistered</span><br /><span class="line"> 5 SIM module registered</span><br /><span class="line"> 4 sent bus device reset to target</span><br /><span class="line"> 3 SCSI AEN</span><br /><span class="line"> 2 reserved</span><br /><span class="line"> 1 unsolicited reselection</span><br /><span class="line"> 0 unsolicited SCSI bus reset</span><br /><span class="line"></span><br /><span class="line">Format of Six-Byte SCSI Command Descriptor Block (CDB):</span><br /><span class="line">Offset Size    Description (Table 2907)</span><br /><span class="line"> 00h   BYTE    operation code (see #2910)</span><br /><span class="line"> 01h   BYTE    logical unit number (bits 7-5), SCSI-1/SCSI-2</span><br /><span class="line">       MSB of logical block address (bits 4-0)</span><br /><span class="line"> 02h   WORD    logical block address (low word)</span><br /><span class="line"> 04h   BYTE    transfer length</span><br /><span class="line"> 05h   BYTE    control byte</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #2908,#2909</span><br /><span class="line"></span><br /><span class="line">Format of Ten-Byte SCSI Command Descriptor Block (CDB):</span><br /><span class="line">Offset Size    Description (Table 2908)</span><br /><span class="line"> 00h   BYTE    operation code (see #2910)</span><br /><span class="line"> 01h   BYTE    logical unit number (bits 7-5), SCSI-1/SCSI-2</span><br /><span class="line">       reserved in SCSI-3</span><br /><span class="line"> 02h   DWORD   logical block address (low word)</span><br /><span class="line"> 06h   BYTE    reserved</span><br /><span class="line"> 07h   WORD    transfer length</span><br /><span class="line"> 09h   BYTE    control byte</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #2907,#2909</span><br /><span class="line"></span><br /><span class="line">Format of Twelve-Byte SCSI Command Descriptor Block (CDB):</span><br /><span class="line">Offset Size    Description (Table 2909)</span><br /><span class="line"> 00h   BYTE    operation code (see #2910)</span><br /><span class="line"> 01h   BYTE    logical unit number (bits 7-5), SCSI-1/SCSI-2</span><br /><span class="line">       reserved in SCSI-3</span><br /><span class="line"> 02h   DWORD   logical block address (low word)</span><br /><span class="line"> 06h   DWORD   transfer length</span><br /><span class="line"> 0Ah   BYTE    reserved</span><br /><span class="line"> 0Bh   BYTE    control byte</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #2907,#2908</span><br /><span class="line"></span><br /><span class="line">(Table 2910)</span><br /><span class="line">Values for SCSI CDB operation code for direct-access devices:</span><br /><span class="line"> 00h   Test Unit Ready</span><br /><span class="line"> 01h   Rezero Unit</span><br /><span class="line"> 03h   Request Sense</span><br /><span class="line"> 04h   Format Unit</span><br /><span class="line"> 07h   Reassign Blocks</span><br /><span class="line"> 08h   Read (6-byte CDB)</span><br /><span class="line"> 0Ah   Write (6-byte CDB)</span><br /><span class="line"> 0Bh   Seek (6-byte CDB)</span><br /><span class="line"> 12h   Inquiry</span><br /><span class="line"> 15h   Mode Select (6-byte CDB)</span><br /><span class="line"> 16h   Reserve</span><br /><span class="line"> 17h   Release</span><br /><span class="line"> 18h   Copy</span><br /><span class="line"> 1Ah   Mode Sense (6-byte CDB)</span><br /><span class="line"> 1Bh   Start/Stop Unit</span><br /><span class="line"> 1Ch   Receive Diagnostic Results</span><br /><span class="line"> 1Dh   Send Diagnostic</span><br /><span class="line"> 1Eh   Prevent/Allow Medium Removal</span><br /><span class="line"> 25h   Read Capacity</span><br /><span class="line"> 28h   Read (10-byte CDB)</span><br /><span class="line"> 2Ah   Write (10-byte CDB)</span><br /><span class="line"> 2Bh   Seek (10-byte CDB)</span><br /><span class="line"> 2Eh   Write and Verify</span><br /><span class="line"> 2Fh   Verify</span><br /><span class="line"> 30h   Search Data High</span><br /><span class="line"> 31h   Search Data Equal</span><br /><span class="line"> 32h   Search Data Low</span><br /><span class="line"> 33h   Set Limits</span><br /><span class="line"> 34h   Prefetch</span><br /><span class="line"> 35h   Synchronize Cache</span><br /><span class="line"> 36h   Lock/Unlock Cache</span><br /><span class="line"> 37h   Read Defect Data</span><br /><span class="line"> 39h   Compare</span><br /><span class="line"> 3Ah   Copy and Verify</span><br /><span class="line"> 3Bh   Write Buffer</span><br /><span class="line"> 3Ch   Read Buffer</span><br /><span class="line"> 3Eh   Read Long</span><br /><span class="line"> 3Fh   Write Long</span><br /><span class="line"> 40h   Change Definition</span><br /><span class="line"> 41h   Write Same</span><br /><span class="line"> 4Ch   Log Select</span><br /><span class="line"> 4Dh   Log Sense</span><br /><span class="line"> 55h   Mode Select (10-byte CDB)</span><br /><span class="line"> 5Ah   Mode Sense (10-byte CDB)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #2907,#2908,#2909</span><br /><span class="line"></span><br /><span class="line">(Table 2911)</span><br /><span class="line">Values completion callback function is called with:</span><br /><span class="line">   interrupts disabled</span><br /><span class="line">   ES:BX -&gt; completed CCB</span><br /><span class="line"></span><br /><span class="line">(Table 2912)</span><br /><span class="line">Values asynchronous callback function is called with:</span><br /><span class="line">   AH = opcode</span><br /><span class="line">   AL = path ID generating callback</span><br /><span class="line">   DH = target ID causing event</span><br /><span class="line">   DL = LUN causing event</span><br /><span class="line">   CX = data byte count (if applicable)</span><br /><span class="line">   ES:BX -&gt; data buffer (if applicable)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> all registers preserved</span><br /></pre>
  
  
  


      </article>

    </section>

  </body>

</html>

