





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-2395028.html">
    <link rel="next" href="rbint-2408880.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="../index.html">Guides</a></li>


          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-2395028.html">Previous</a></li>


          

<li><a href="rbint-2204700.html">Up</a></li>


          

<li><a href="rbint-2408880.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Lists</li>
            <ul>
              <li><a href="index.html">Comments</a></li>
              <li><a href="rbint-7995.html">Interrupts</a></li>
              <li><a href="rbint-15401.html">Glossary</a></li>
              <li><a href="rbint-64347.html">Memory</a></li>
              <li><a href="rbint-180090.html">CMOS</a></li>
              <li><a href="rbint-250757.html">86 Bugs</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br /><span class="line"><span class="ngu">Int 21 Fn 440D  - Dos 3.2+ - Ioctl - Generic Block Device Request        </span>  [<span class="ngb">D</span>]</span><br /><span class="line"></span><br /><span class="line">   AX = 440Dh</span><br /><span class="line">   BL = drive number (00h=default,01h=A:,etc)</span><br /><span class="line">   CH = category code (see #1245)</span><br /><span class="line">   CL = minor code (function) (see #1246)</span><br /><span class="line">   DS:DX -&gt; (DOS) parameter block (see #1247,#1249,#1250,#1251,#1252)</span><br /><span class="line">   SI:DI -&gt; (OS/2 comp box) parameter block (see #1253,#1255,#1256,#1259)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> CF set on error</span><br /><span class="line">       AX = error code (01h,02h,etc.) (see #1366 at AH=59h/BX=0000h)</span><br /><span class="line">   CF clear if successful</span><br /><span class="line">       DS:DX -&gt; data block if CL=60h or CL=61h</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> DOS 4.01 seems to ignore the high byte of the number of directory</span><br /><span class="line">     entries in the BPB for diskettes.</span><br /><span class="line">   functions 46h and 66h undocumented in DOS 4.x, documented for DOS 5+</span><br /><span class="line">   the DUBLDISK.SYS v2.6 driver only supports minor codes 60h and 67h</span><br /><span class="line">   DR DOS 3.41-6.0 only support minor codes 40h-42h and 60h-62h; all</span><br /><span class="line">     other minor codes return error code 16h</span><br /><span class="line">   some PCMCIA calls reportedly appear to be dangerous for MS-DOS versions</span><br /><span class="line">     prior to 5.0</span><br /><span class="line">   minor code 60h normally produces no I/O except with AutoMount=1 for</span><br /><span class="line">     DBLSPACE/DRVSPACE</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> AX=440Ch,AX=440Dh/CX=084Ah,AX=440Dh/CX=0871h,AH=69h,INT 2F/AX=0802h</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> INT 2F/AX=122Bh</span><br /><span class="line"></span><br /><span class="line">(Table 1245)</span><br /><span class="line">Values for block device IOCTL category code:</span><br /><span class="line"> 08h   disk drive</span><br /><span class="line"> 48h   FAT32 disk drive</span><br /><span class="line"> 00h-7Fh reserved for Microsoft</span><br /><span class="line"> 80h-FFh reserved for OEM/user-defined</span><br /><span class="line"></span><br /><span class="line">(Table 1246)</span><br /><span class="line">Values for generic block IOCTL minor code:</span><br /><span class="line"> 00h   (OS/2)  \ used to lock/unlock a drive</span><br /><span class="line"> 01h   (OS/2)  /</span><br /><span class="line"> 40h   set device parameters (see #1247)</span><br /><span class="line"> 41h   write logical device track (see #1249)</span><br /><span class="line"> 42h   format and verify logical device track (see #1250)</span><br /><span class="line"> 46h   (DOS 4.0+) set volume serial number (see #1252,AH=69h)</span><br /><span class="line"> 47h   (DOS 4.0+) set access flag (see #1253)</span><br /><span class="line"> 48h   (Enh. Disk Drive Spec) set media lock state (see #1254,INT 13/AH=45h)</span><br /><span class="line"> 49h   (Enh. Disk Drive Spec) eject media in drive (see INT 13/AH=49h)</span><br /><span class="line">   no parameter block required</span><br /><span class="line"> 4Ah   (MS-DOS 7.0) lock logical volume (see AX=440Dh/CX=084Ah)</span><br /><span class="line"> 4Bh   (MS-DOS 7.0) lock physical volume (see AX=440Dh/CX=084Bh)</span><br /><span class="line"> 50h   (PCMCIA) attribute memory write</span><br /><span class="line"> 51h   (PCMCIA) common memory write</span><br /><span class="line"> 52h   (PCMCIA) force media change (DOS 5+ ???) (see #1255)</span><br /><span class="line"> 53h   (PCMCIA) erase drive</span><br /><span class="line"> 54h   (PCMCIA) erase media</span><br /><span class="line"> 56h   (PCMCIA) set erase status callback</span><br /><span class="line"> 57h   (PCMCIA) append Card Information Structure (CIS) tuple</span><br /><span class="line"> 58h   (PCMCIA) erase CIS tuples</span><br /><span class="line"> 60h   get device parameters (see #1247)</span><br /><span class="line"> 61h   read logical device track (see #1249)</span><br /><span class="line"> 62h   verify logical device track (see #1251)</span><br /><span class="line"> 66h   (DOS 4.0+) get volume serial number (see #1252,AH=69h)</span><br /><span class="line"> 67h   (DOS 4.0+) get access flag (see #1253)</span><br /><span class="line"> 68h   (DOS 5.0+) sense media type (see #1256)</span><br /><span class="line"> 6Ah   (MS-DOS 7.0) unlock logical volume (see AX=440Dh/CX=086Ah)</span><br /><span class="line">   no parameter block required</span><br /><span class="line"> 6Bh   (MS-DOS 7.0) unlock physical volume (see AX=440Dh/CX=086Bh)</span><br /><span class="line">   no parameter block required</span><br /><span class="line"> 6Ch   (MS-DOS 7.0) get lock flag (see AX=440Dh/CX=086Ch)</span><br /><span class="line">   no parameter block required</span><br /><span class="line"> 6Dh   (MS-DOS 7.0) enumerate open files (see AX=440Dh/CX=086Dh)</span><br /><span class="line"> 6Eh   (MS-DOS 7.0) find swap file (see AX=440Dh/CX=086Eh)</span><br /><span class="line"> 6Fh   (MS-DOS 7.0) get drive map information (see #1257)</span><br /><span class="line"> 70h   (PCMCIA) attribute memory read</span><br /><span class="line"> 70h   (MS-DOS 7.0) get current lock state (see AX=440Dh/CX=0870h)</span><br /><span class="line">   no parameter block required</span><br /><span class="line"> 71h   (MS-DOS 7.0) get first cluster (see AX=440Dh/CX=0871h)</span><br /><span class="line"> 73h   (PCMCIA) get memory media information (DOS 5+ ???) (see #1259)</span><br /><span class="line"> 76h   (PCMCIA) get erase status callback</span><br /><span class="line"> 77h   (PCMCIA) get first Card Information Structure (CIS) tuple</span><br /><span class="line"> 78h   (PCMCIA) get next CIS tuple</span><br /><span class="line"> 7Fh   (PCMCIA) get ??? information (see #1260,#1261)</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for functions 40h, 60h:</span><br /><span class="line">Offset Size    Description (Table 1247)</span><br /><span class="line"> 00h   BYTE    special functions</span><br /><span class="line">       bit 0 set if function to use current BPB, clear if Device</span><br /><span class="line">             BIOS Parameter Block field contains new default BPB</span><br /><span class="line">       bit 1 set if function to use track layout fields only</span><br /><span class="line">           must be clear if CL=60h</span><br /><span class="line">       bit 2 set if all sectors in track same size (should be set)</span><br /><span class="line">       bits 3-7 reserved (MS-DOS, Novell DOS 7)</span><br /><span class="line">       bit 5: skip head settling time (WinDOS 2.11)</span><br /><span class="line">       bit 6: format access flag (WinDOS 2.11)</span><br /><span class="line"> 01h   BYTE    device type (see #1248)</span><br /><span class="line"> 02h   WORD    device attributes</span><br /><span class="line">       bit 0 set if nonremovable medium</span><br /><span class="line">       bit 1 set if door lock (&#34;changeline&#34;) supported</span><br /><span class="line">       bits 2-15 reserved</span><br /><span class="line"> 04h   WORD    number of cylinders</span><br /><span class="line"> 06h   BYTE    media type</span><br /><span class="line">       for 1.2M drive</span><br /><span class="line">           00h 1.2M disk (default)</span><br /><span class="line">           01h 320K/360K disk</span><br /><span class="line">       F8h for DUBLDISK.SYS v2.6 expanded drives</span><br /><span class="line">       always 00h for other drive types</span><br /><span class="line"> 07h 31 BYTEs  device BPB (see #1349 at AH=53h), bytes after BPB offset 1Eh</span><br /><span class="line">         omitted; final six bytes only transferred on function 40h</span><br /><span class="line">         with BYTE 00h bit 0 set for MS-DOS 5.0</span><br /><span class="line">---function 40h only---</span><br /><span class="line"> 26h   WORD    number of sectors per track (start of track layout field)</span><br /><span class="line">       (maximum 63)</span><br /><span class="line"> 28h  N word pairs: number,size of each sector in track</span><br /><span class="line">---category code 48h (FAT32), function 40h---</span><br /><span class="line"> 07h 53 BYTEs  extended BPB (see #1350)</span><br /><span class="line"> 3Ch 32 BYTEs  reserved</span><br /><span class="line"> 5Ch   WORD    number of track table entries</span><br /><span class="line"> 5Eh 2N WORDs  sector table (word pairs: number/size of each sector in track)</span><br /><span class="line">---category code 48h (FAT32), function 60h---</span><br /><span class="line"> 07h 53 BYTEs  extended BPB (see #1350)</span><br /><span class="line"> 3Ch 32 BYTEs  reserved</span><br /><span class="line"></span><br /><span class="line">(Table 1248)</span><br /><span class="line">Values for device type:</span><br /><span class="line"> 00h   320K/360K disk</span><br /><span class="line"> 01h   1.2M disk</span><br /><span class="line"> 02h   720K disk</span><br /><span class="line"> 03h   single-density 8-inch disk</span><br /><span class="line"> 04h   double-density 8-inch disk</span><br /><span class="line"> 05h   fixed disk</span><br /><span class="line"> 06h   tape drive</span><br /><span class="line"> 07h   (DOS 3.3+) other type of block device, normally 1.44M floppy</span><br /><span class="line"> 08h   read/write optical disk</span><br /><span class="line"> 09h   (DOS 5+) 2.88M floppy</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for functions 41h, 61h:</span><br /><span class="line">Offset Size    Description (Table 1249)</span><br /><span class="line"> 00h   BYTE    special functions (reserved, must be zero)</span><br /><span class="line"> 01h   WORD    number of disk head</span><br /><span class="line"> 03h   WORD    number of disk cylinder</span><br /><span class="line"> 05h   WORD    number of first sector to read/write</span><br /><span class="line"> 07h   WORD    number of sectors</span><br /><span class="line"> 09h   DWORD   transfer address</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Note:</span>  under Windows95, a volume must be locked (see AX=440Dh/CX=084Bh) in</span><br /><span class="line">     order to perform direct accesses such as track reads and writes</span><br /><span class="line">     with this IOCTL function</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 42h:</span><br /><span class="line">Offset Size    Description (Table 1250)</span><br /><span class="line"> 00h   BYTE    reserved, must be zero (DOS &lt;3.2)</span><br /><span class="line">         bit 0=0: format/verify track</span><br /><span class="line">           1: format status call (DOS 3.2+), don&#39;t actually format</span><br /><span class="line">         bit 1: format multiple tracks, require additional WORD</span><br /><span class="line">             (hard disks only)</span><br /><span class="line">         bits 2-7 reserved, must be zero</span><br /><span class="line">       value on return (DOS 3.3+):</span><br /><span class="line">         00h   specified tracks, sectors/track supported by BIOS</span><br /><span class="line">         01h   function not supported by BIOS</span><br /><span class="line">         02h   specified tracks, sectors/track not allowed for drive</span><br /><span class="line">         03h   no disk in drive</span><br /><span class="line"> 01h   WORD    number of disk head</span><br /><span class="line"> 03h   WORD    number of disk cylinder</span><br /><span class="line">---BYTE 00h bit 1 set---</span><br /><span class="line"> 05h   WORD    number of tracks to format</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 62h:</span><br /><span class="line">Offset Size    Description (Table 1251)</span><br /><span class="line"> 00h   BYTE    reserved, must be zero (DOS &lt;3.2)</span><br /><span class="line">         bit 0=0: verify single track</span><br /><span class="line">           1: verify multiple tracks</span><br /><span class="line">         bits 1-7 reserved, must be zero</span><br /><span class="line">       value on return (DOS 3.3+):</span><br /><span class="line">         00h   specified tracks, sectors/track supported by BIOS</span><br /><span class="line">         01h   function not supported by BIOS</span><br /><span class="line">         02h   specified tracks, sectors/track not allowed for drive</span><br /><span class="line">         03h   no disk in drive</span><br /><span class="line"> 01h   WORD    number of disk head</span><br /><span class="line"> 03h   WORD    number of disk cylinder</span><br /><span class="line"> 05h   WORD    number of tracks to verify (equivalent to 255 or fewer sectors)</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for functions 46h, 66h:</span><br /><span class="line">Offset Size    Description (Table 1252)</span><br /><span class="line"> 00h   WORD    (call) info level (should be 0000h)</span><br /><span class="line"> 02h   DWORD   disk serial number (binary)</span><br /><span class="line"> 06h 11 BYTEs  volume label or &#34;NO NAME    &#34;</span><br /><span class="line"> 11h  8 BYTEs  filesystem type &#34;FAT12   &#34; or &#34;FAT16   &#34;</span><br /><span class="line">         (generally CL=66h only, but MS-DOS 5.0 will write the</span><br /><span class="line">         given filesystem type to the disk)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Note:</span>  under MS-DOS 7.0 or a Windows95 DOS box, the volume label field can</span><br /><span class="line">     return as all blanks even when a volume label has been set (the Win95</span><br /><span class="line">     installation seems to blank the volume label field in the partition</span><br /><span class="line">     boot sector; once LABEL has been run, the volume label is reported</span><br /><span class="line">     correctly)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> AH=69h</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for functions 47h, 67h:</span><br /><span class="line">Offset Size    Description (Table 1253)</span><br /><span class="line"> 00h   BYTE    special-function field (must be zero)</span><br /><span class="line"> 01h   BYTE    disk-access flag, nonzero if access allowed by driver</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 48h:</span><br /><span class="line">Offset Size    Description (Table 1254)</span><br /><span class="line"> 00h   BYTE    (call) locking operation</span><br /><span class="line">       00h lock media in drive</span><br /><span class="line">       01h unlock media</span><br /><span class="line">       02h get locking status</span><br /><span class="line"> 01h   BYTE    (ret) drive&#39;s lock status (number of pending locks on drive)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Note:</span>  also supported by MS-DOS 7.0</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 52h:</span><br /><span class="line"> 00h   BYTE    (call) unused???    (Table 1255)</span><br /><span class="line">       (ret) 00h if flash/ATA drive but no card inserted</span><br /><span class="line">           unchanged otherwise</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> the absense of a flash card should be tested by checking the DOS error</span><br /><span class="line">     code rather than the returned byte</span><br /><span class="line">   the parameter byte is cleared to 00h erroneously by the Award</span><br /><span class="line">     PCDISK.EXE v1.02c PCMCIA/ATA driver if no ATA card is inserted</span><br /><span class="line">     (bug corrected in PCDISK.EXE v1.02h and later)</span><br /><span class="line">   not supported by the SystemSoft ATADRV.EXE and the Phoenix PCMATA.SYS</span><br /><span class="line">     PCMCIA/ATA drivers</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 68h:</span><br /><span class="line">Offset Size    Description (Table 1256)</span><br /><span class="line"> 00h   BYTE    01h for default media type, 00h for any other media type</span><br /><span class="line">       (see also INT 13/AH=20h&#34;Compaq&#34;)</span><br /><span class="line"> 01h   BYTE    02h for 720K, 07h for 1.44M, 09h for 2.88M</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 6Fh:</span><br /><span class="line">Offset Size    Description (Table 1257)</span><br /><span class="line"> 00h   BYTE    (call) length of this buffer (in bytes)</span><br /><span class="line"> 01h   BYTE    (ret) number of bytes in parameter block actually used</span><br /><span class="line"> 02h   BYTE    (ret) drive flags (see #1258)</span><br /><span class="line"> 03h   BYTE    (ret) physical drive number</span><br /><span class="line">       00h-7Fh floppy</span><br /><span class="line">       80h-FEh hard</span><br /><span class="line">       FFh no physical drive</span><br /><span class="line"> 04h   DWORD   (ret) bitmap of logical drives associated with physical drive</span><br /><span class="line">       bit 0 = drive A:, etc.</span><br /><span class="line"> 08h   QWORD   (ret) relative block address of partition start</span><br /><span class="line"></span><br /><span class="line">Bitfields for Get Drive Map Information drive flags:</span><br /><span class="line">Bit(s) Description (Table 1258)</span><br /><span class="line"> 0 protected-mode driver for logical drive</span><br /><span class="line"> 1 protected-mode driver in use for physical drive corresponding to the</span><br /><span class="line">     logical drive</span><br /><span class="line"> 2 drive available only in protected mode</span><br /><span class="line"> 3 protected-mode drive supports media ejection</span><br /><span class="line"> 4 drive issues media insertion and removal notifications</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1257</span><br /><span class="line"></span><br /><span class="line">Format of parameter block for function 73h:</span><br /><span class="line">Offset Size    Description (Table 1259)</span><br /><span class="line"> 00h   BYTE    ???</span><br /><span class="line">       00h ATA card inserted ???</span><br /><span class="line">       80h ATA card not inserted ???</span><br /><span class="line"> 01h   BYTE    length of parameter block ???</span><br /><span class="line">       apparently always 40h</span><br /><span class="line"> 02h   BYTE    ???</span><br /><span class="line">       00h ATA card not inserted ???</span><br /><span class="line">       0Dh ATA card inserted ???</span><br /><span class="line"> 03h  2 BYTEs  ??? (apparently always 00h)</span><br /><span class="line"> 05h   BYTE    drive number (0=first) ???</span><br /><span class="line"> 06h   BYTE    total number of drives ???</span><br /><span class="line"> 07h   BYTE    ???</span><br /><span class="line">       00h ATA card not inserted ???</span><br /><span class="line">       01h ATA card inserted ???</span><br /><span class="line"> 08h 17 BYTEs  ???</span><br /><span class="line"> 19h   BYTE    ???</span><br /><span class="line">       00h ATA card not inserted ???</span><br /><span class="line">       01h ATA card inserted ???</span><br /><span class="line"> 1Ah   BYTE    ??? (apparently always 01h)</span><br /><span class="line"> 1Bh   BYTE    ???</span><br /><span class="line">       00h ATA card not inserted ???</span><br /><span class="line">       01h ATA card inserted ???</span><br /><span class="line"> 1Ch  2 BYTEs  ??? (apparently always 0015h)</span><br /><span class="line"> 1Eh  2 BYTEs  ???</span><br /><span class="line"> 20h  2 BYTEs  ??? (apparently always 0110h)</span><br /><span class="line"> 22h 15 BYTEs  ???</span><br /><span class="line"> 31h  2 BYTEs  ??? (apparently always 7000h)</span><br /><span class="line"> 33h 11 BYTEs  driver signature</span><br /><span class="line">       &#34;AWARD PDISK&#34; for Award PCDISK.EXE PCMCIA/ATA driver</span><br /><span class="line">       &#34;MS-BIOS    &#34; for HP 200LX generic ATA driver</span><br /><span class="line"> 3Eh  2 BYTEs  ???</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> parameter structure possibly depends on driver</span><br /><span class="line">   this function is not supported by the SystemSoft ATADRV.EXE and the</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">.NG limit reached, continued in next section...</span></span><br /></pre>
  
  
  


      </article>

    </section>

  </body>

</html>

