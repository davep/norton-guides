





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="rbint-style.css">
    <title>Ralf Brown » Lists » Interrupts</title>
    <meta name="description" content="Ralf Brown">
    <link rel="prev" href="rbint-2496892.html">
    <link rel="next" href="rbint-2508879.html">
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="rbint-about.html">About</a></li>


          

<li><a href="rbint-2496892.html">Previous</a></li>


          

<li><a href="rbint-2471063.html">Up</a></li>


          

<li><a href="rbint-2508879.html">Next</a></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Lists</li>
            <ul>
              <li><a href="index.html">Comments</a></li>
              <li><a href="rbint-7995.html">Interrupts</a></li>
              <li><a href="rbint-15401.html">Glossary</a></li>
              <li><a href="rbint-64347.html">Memory</a></li>
              <li><a href="rbint-180090.html">CMOS</a></li>
              <li><a href="rbint-250757.html">86 Bugs</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line"></span><br /><span class="line"><span class="ngu">Int 21 Fn 52  U - Dos 2+ Internal - &#34;sysvars&#34; - Get List Of Lists        </span>  [<span class="ngb">D</span>]</span><br /><span class="line"></span><br /><span class="line">   AH = 52h</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Return:</span> ES:BX -&gt; DOS list of lists (see #1313)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> partially supported by OS/2 v1.1 compatibility box (however, most</span><br /><span class="line">     pointers are FFFFh:FFFFh, LASTDRIVE is FFh, and the NUL header &#34;next&#34;</span><br /><span class="line">     pointer is FFFFh:FFFFh).</span><br /><span class="line">   partially supported by the Windows NT DOS box; contains only a</span><br /><span class="line">     rudimentary Current Directory Structure (see #1331)</span><br /><span class="line">   on return, ES points at the DOS data segment (see also INT 2F/AX=1203h)</span><br /><span class="line">   Quarterdeck&#39;s suggested check for the use of its DOSDATA.SYS or</span><br /><span class="line">     DOS-UP.SYS is to test whether the list-of-lists segment is greater</span><br /><span class="line">     than the segment of the first memory block; a better check for</span><br /><span class="line">     DOS-UP.SYS is INT 21/AX=2B01h/CX=444Dh</span><br /><span class="line">   because not all DOS workalikes support all fields in the List of Lists,</span><br /><span class="line">     applications should ensure that pointers are neither 0000h:0000h</span><br /><span class="line">     nor FFFFh:FFFFh before using them</span><br /><span class="line">   Windows for Workgroups 3.11 network and Windows95 set the path to</span><br /><span class="line">     the local drive and directory even for network drives; in that</span><br /><span class="line">     case the UNC form \\SERVER\SHARE can be obtained with</span><br /><span class="line">     INT 21/AX=5F02h or INT 21/AX=5F46h. LapLink RemoteAccess does the</span><br /><span class="line">     same even for INT 21/AX=5F02h</span><br /><span class="line">   Windows95 GUI no longer returns the true path for a SUBSTed drive,</span><br /><span class="line">     but MS-DOS 7.00 does; use INT 21/AH=60h to obtain the true name</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> INT 2F/AX=1203h</span><br /><span class="line"></span><br /><span class="line">Format of List of Lists:</span><br /><span class="line">Offset Size    Description (Table 1313)</span><br /><span class="line"> -24   WORD    (DOS 3.1+) contents of CX from INT 21/AX=5E01h</span><br /><span class="line"> -22   WORD    (DOS ???+) LRU counter for FCB caching</span><br /><span class="line"> -20   WORD    (DOS ???+) LRU counter for FCB opens</span><br /><span class="line"> -18   DWORD   (DOS ???+) address of OEM function handler (see INT 21/AH=F8h)</span><br /><span class="line">           FFFFh:FFFFh if not installed or not available</span><br /><span class="line"> -14   WORD    (DOS ???+) offset in DOS CS of code to return from INT 21 call</span><br /><span class="line"> -12   WORD    (DOS 3.1+) sharing retry count (see AX=440Bh)</span><br /><span class="line"> -10   WORD    (DOS 3.1+) sharing retry delay (see AX=440Bh)</span><br /><span class="line"> -8    DWORD   (DOS 3.0+) pointer to current disk buffer</span><br /><span class="line"> -4    WORD    (DOS 3.0+) pointer in DOS data segment of unread CON input</span><br /><span class="line">       when CON is read via a handle, DOS reads an entire line,</span><br /><span class="line">         and returns the requested portion, buffering the rest</span><br /><span class="line">         for the next read.  0000h indicates no unread input</span><br /><span class="line"> -2    WORD    segment of first memory control block (see #1314)</span><br /><span class="line"> 00h   DWORD   pointer to first Drive Parameter Block (see #1083 at AH=32h)</span><br /><span class="line"> 04h   DWORD   -&gt; first System File Table (see #1325,#1326,#1327,#1328)</span><br /><span class="line"> 08h   DWORD   pointer to active CLOCK$ device&#39;s header (most recently loaded</span><br /><span class="line">         driver with CLOCK bit set)</span><br /><span class="line"> 0Ch   DWORD   pointer to active CON device&#39;s header (most recently loaded</span><br /><span class="line">         driver with STDIN bit set)</span><br /><span class="line">---DOS 2.x---</span><br /><span class="line"> 10h   BYTE    number of logical drives in system</span><br /><span class="line"> 11h   WORD    maximum bytes/block of any block device</span><br /><span class="line"> 13h   DWORD   pointer to first disk buffer (see #1335,#1336)</span><br /><span class="line"> 17h 18 BYTEs  actual NUL device driver header (not a pointer!)</span><br /><span class="line">       NUL is always the first device on DOS&#39;s linked list of device</span><br /><span class="line">         drivers. (see #1332)</span><br /><span class="line">---DOS 3.0---</span><br /><span class="line"> 10h   BYTE    number of block devices</span><br /><span class="line"> 11h   WORD    maximum bytes/block of any block device</span><br /><span class="line"> 13h   DWORD   pointer to first disk buffer (see #1336,#1338)</span><br /><span class="line"> 17h   DWORD   pointer to array of current directory structures (see #1329)</span><br /><span class="line"> 1Bh   BYTE    value of LASTDRIVE command in CONFIG.SYS (default 5)</span><br /><span class="line"> 1Ch   DWORD   pointer to STRING= workspace area</span><br /><span class="line"> 20h   WORD    size of STRING area (the x in STRING=x from CONFIG.SYS)</span><br /><span class="line"> 22h   DWORD   pointer to FCB table</span><br /><span class="line"> 26h   WORD    the y in FCBS=x,y from CONFIG.SYS</span><br /><span class="line"> 28h 18 BYTEs  actual NUL device driver header (not a pointer!)</span><br /><span class="line">       NUL is always the first device on DOS&#39;s linked list of device</span><br /><span class="line">         drivers. (see #1332)</span><br /><span class="line">---DOS 3.1-3.3---</span><br /><span class="line"> 10h   WORD    maximum bytes per sector of any block device</span><br /><span class="line"> 12h   DWORD   pointer to first disk buffer in buffer chain (see #1336)</span><br /><span class="line"> 16h   DWORD   pointer to array of current directory structures (see #1329)</span><br /><span class="line"> 1Ah   DWORD   pointer to system FCB tables (see #1326,#1327,#1328)</span><br /><span class="line"> 1Eh   WORD    number of protected FCBs (the y in the CONFIG.SYS FCBS=x,y)</span><br /><span class="line"> 20h   BYTE    number of block devices installed</span><br /><span class="line"> 21h   BYTE    number of available drive letters (largest of 5, installed</span><br /><span class="line">         block devices, and CONFIG.SYS LASTDRIVE=).  Also size of</span><br /><span class="line">         current directory structure array.</span><br /><span class="line"> 22h 18 BYTEs  actual NUL device driver header (not a pointer!)</span><br /><span class="line">       NUL is always the first device on DOS&#39;s linked list of device</span><br /><span class="line">         drivers. (see #1332)</span><br /><span class="line"> 34h   BYTE    number of JOIN&#39;ed drives</span><br /><span class="line">---DOS 4.x---</span><br /><span class="line"> 10h   WORD    maximum bytes per sector of any block device</span><br /><span class="line"> 12h   DWORD   pointer to disk buffer info record (see #1338,#1339)</span><br /><span class="line"></span><br /><span class="line">       <span class="ngb">Note:</span> although the initialization code in IO.SYS uses this</span><br /><span class="line">         pointer, MSDOS.SYS does not, instead using the hardcoded</span><br /><span class="line">         address of the info record</span><br /><span class="line"> 16h   DWORD   pointer to array of current directory structures</span><br /><span class="line">       (see #1329,#1330)</span><br /><span class="line"> 1Ah   DWORD   pointer to system FCB tables (see #1326,#1327,#1328)</span><br /><span class="line"> 1Eh   WORD    number of protected FCBs (the y in the CONFIG.SYS FCBS=x,y)</span><br /><span class="line">       (always 00h for DOS 5.0)</span><br /><span class="line"> 20h   BYTE    number of block devices installed</span><br /><span class="line"> 21h   BYTE    number of available drive letters (largest of 5, installed</span><br /><span class="line">         block devices, and CONFIG.SYS LASTDRIVE=).  Also size of</span><br /><span class="line">         current directory structure array.</span><br /><span class="line"> 22h 18 BYTEs  actual NUL device driver header (not a pointer!)</span><br /><span class="line">       NUL is always the first device on DOS&#39;s linked list of device</span><br /><span class="line">         drivers. (see #1332)</span><br /><span class="line"> 34h   BYTE    number of JOIN&#39;ed drives</span><br /><span class="line"> 35h   WORD    pointer within IBMDOS code segment to list of special program</span><br /><span class="line">         names (see #1348)</span><br /><span class="line">       (always 0000h for DOS 5.0)</span><br /><span class="line"> 37h   DWORD   pointer to FAR routine for resident IFS utility functions</span><br /><span class="line">       (see #1344)</span><br /><span class="line">       may be called by any IFS driver which does not wish to</span><br /><span class="line">         service functions 20h or 24h-28h itself</span><br /><span class="line"> 3Bh   DWORD   pointer to chain of IFS (installable file system) drivers</span><br /><span class="line"> 3Fh   WORD    the x in BUFFERS x,y (rounded up to multiple of 30 if in EMS)</span><br /><span class="line"> 41h   WORD    number of lookahead buffers (the y in BUFFERS x,y)</span><br /><span class="line"> 43h   BYTE    boot drive (1=A:)</span><br /><span class="line"> 44h   BYTE    flag: 01h to use DWORD moves (80386+), 00h otherwise</span><br /><span class="line"> 45h   WORD    extended memory size in KB</span><br /><span class="line">---DOS 5.0-6.0---</span><br /><span class="line"> 10h 39 BYTEs  as for DOS 4.x (above)</span><br /><span class="line"> 37h   DWORD   pointer to SETVER program list or 0000h:0000h</span><br /><span class="line"> 3Bh   WORD    (DOS=HIGH) offset in DOS CS of function to fix A20 control</span><br /><span class="line">         when executing special .COM format</span><br /><span class="line"> 3Dh   WORD    PSP of most-recently EXECed program if DOS in HMA, 0000h if low</span><br /><span class="line">       used for maintaining count of INT 21 calls which disable A20</span><br /><span class="line">         on return</span><br /><span class="line"> 3Fh  8 BYTEs  as for DOS 4.x (above)</span><br /><span class="line">---Windows NT DOS Box---</span><br /><span class="line"> 10h  6 BYTEs  ???</span><br /><span class="line"> 16h   DWORD   pointer to array of current directory structures (see #1331)</span><br /><span class="line"> 1Ah  6 BYTEs  ???</span><br /><span class="line"> 20h   BYTE    number of block devices installed</span><br /><span class="line"> 21h   BYTE    number of local drive letters (= installed block devices)</span><br /><span class="line">       Also size of current directory structure array.</span><br /><span class="line"> 22h 18 BYTEs  actual NUL device driver header (not a pointer!)</span><br /><span class="line">       NUL is always the first device on DOS&#39;s linked list of device</span><br /><span class="line">         drivers. (see #1332)</span><br /><span class="line"></span><br /><span class="line">Format of DOS memory control block:</span><br /><span class="line">Offset Size    Description (Table 1314)</span><br /><span class="line"> 00h   BYTE    block type: 5Ah if last block in chain, otherwise 4Dh</span><br /><span class="line"> 01h   WORD    PSP segment of owner or special flag value (see #1315)</span><br /><span class="line"> 03h   WORD    size of memory block in paragraphs</span><br /><span class="line"> 05h  3 BYTEs  unused by MS-DOS</span><br /><span class="line">       (386MAX) if locked-out block, region start/prev region end</span><br /><span class="line">---DOS 2.x,3.x---</span><br /><span class="line"> 08h  8 BYTEs  unused</span><br /><span class="line">---DOS 4.0+ ---</span><br /><span class="line"> 08h  8 BYTEs  ASCII program name if PSP memory block or DR DOS UMB,</span><br /><span class="line">         else garbage</span><br /><span class="line">       null-terminated if less than 8 characters</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">Notes:</span> the next MCB is at segment (current + size + 1)</span><br /><span class="line">   under DOS 3.1+, the first memory block is the DOS data segment,</span><br /><span class="line">     containing installable drivers, buffers, etc.  Under DOS 4.0+ it is</span><br /><span class="line">     divided into subsegments, each with its own memory control block</span><br /><span class="line">     (see #1319), the first of which is at offset 0000h.</span><br /><span class="line">   for DOS 5+, blocks owned by DOS may have either &#34;SC&#34; or &#34;SD&#34; in bytes</span><br /><span class="line">     08h and 09h.  &#34;SC&#34; is system code or locked-out inter-UMB memory,</span><br /><span class="line">     &#34;SD&#34; is system data, device drivers, etc.</span><br /><span class="line">   Some versions of DR DOS use only seven characters of the program name,</span><br /><span class="line">     placing a NUL in the eighth byte.</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1316,#1318,#1319</span><br /><span class="line"></span><br /><span class="line">(Table 1315)</span><br /><span class="line">Values for special flag PSP segments:</span><br /><span class="line"> 0000h free</span><br /><span class="line"> 0006h DR DOS XMS UMB</span><br /><span class="line"> 0007h DR DOS excluded upper memory (&#34;hole&#34;)</span><br /><span class="line"> 0008h belongs to DOS</span><br /><span class="line"> FFF7h 386MAX v6.01+ ???</span><br /><span class="line"> FFFAh 386MAX UMB control block (see #1164 at AX=4402h&#34;386MAX&#34;)</span><br /><span class="line"> FFFDh 386MAX locked-out memory</span><br /><span class="line"> FFFEh 386MAX UMB (normally immediately follows its control block)</span><br /><span class="line"> FFFFh 386MAX v6.01+ device driver</span><br /><span class="line"></span><br /><span class="line">Format of MS-DOS 5+ UMB control block:</span><br /><span class="line">Offset Size    Description (Table 1316)</span><br /><span class="line"> 00h   BYTE    type: 5Ah if last block in chain, 4Dh otherwise</span><br /><span class="line"> 01h   WORD    first available paragraph in UMB if control block at start</span><br /><span class="line">         of UMB, 000Ah if control block at end of UMB</span><br /><span class="line"> 03h   WORD    length in paragraphs of following UMB or locked-out region</span><br /><span class="line"> 05h  3 BYTEs  unused</span><br /><span class="line"> 08h  8 BYTEs  block type name: &#34;UMB&#34; if start block, &#34;SM&#34; if end block in UMB</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1314,#1317</span><br /><span class="line"></span><br /><span class="line">Format of MS-DOS 7.0 HMA memory control block:</span><br /><span class="line">Offset Size    Description (Table 1317)</span><br /><span class="line"> 00h   WORD    signature &#34;MS&#34; (4Dh 53h)</span><br /><span class="line"> 02h   WORD    usage flag???</span><br /><span class="line">       0000h free</span><br /><span class="line">       else ???</span><br /><span class="line"> 04h   WORD    size of memory block in bytes (not counting MCB)</span><br /><span class="line"> 06h   WORD    offset of next memory block in HMA or 0000h</span><br /><span class="line"> 08h  8 BYTEs  unused (0)</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">See Also:</span> #1314,#1316,#1318</span><br /><span class="line"></span><br /><span class="line">Format of STARLITE (General Software&#39;s Embedded DOS) memory control block:</span><br /><span class="line">Offset Size    Description (Table 1318)</span><br /><span class="line"> 00h   BYTE    block type: 5Ah if last block in chain, otherwise 4Dh</span><br /><span class="line"> 01h   WORD    PSP segment of owner, 0000h if free, 0008h if belongs to DOS</span><br /><span class="line"> 03h   WORD    size of memory block in paragraphs</span><br /><span class="line"> 05h   BYTE    unused</span><br /><span class="line"> 06h   WORD    segment address of next memory control block (0000h if last)</span><br /><span class="line"> 08h   WORD    segment address of previous memory control block or 0000h</span><br /><span class="line"> 0Ah  6 BYTEs  reserved</span><br /><span class="line"></span><br /><span class="line">Format of DOS 4.0+ data segment subsegment control blocks:</span><br /><span class="line">Offset Size    Description (Table 1319)</span><br /><span class="line"> 00h   BYTE    subsegment type (blocks typically appear in this order)</span><br /><span class="line">       &#34;D&#34;  device driver</span><br /><span class="line">       &#34;E&#34;  device driver appendage</span><br /><span class="line">       &#34;I&#34;  IFS (Installable File System) driver</span><br /><span class="line">            (MS-DOS 7) high-loaded drive data table array (see #2290)</span><br /><span class="line">       &#34;F&#34;  FILES=  control block storage area (for FILES&gt;5)</span><br /><span class="line">       &#34;X&#34;  FCBS=   control block storage area, if present</span><br /><span class="line">       &#34;C&#34;  BUFFERS EMS workspace area (if BUFFERS /X option used)</span><br /><span class="line">       &#34;B&#34;  BUFFERS=  storage area</span><br /><span class="line">       &#34;L&#34;  LASTDRIVE=  current directory structure array storage area</span><br /><span class="line">       &#34;S&#34;  STACKS=  code and data area, if present (see #1320,#1321)</span><br /><span class="line">       &#34;T&#34;  INSTALL= transient code</span><br /><span class="line"> 01h   WORD    paragraph of subsegment start (usually the next paragraph)</span><br /><span class="line"> 03h   WORD    size of subsegment in paragraphs</span><br /><span class="line"> 05h  3 BYTEs  unused</span><br /><span class="line"> 08h  8 BYTEs  for types &#34;D&#34; and &#34;I&#34;, base name of file from which the driver</span><br /><span class="line">         was loaded (unused for other types)</span><br /><span class="line"></span><br /><span class="line">Format of data at start of STACKS code segment (if present):</span><br /><span class="line">Offset Size    Description (Table 1320)</span><br /><span class="line"> 00h   WORD    ???</span><br /><span class="line"> 02h   WORD    number of stacks (the x in STACKS=x,y)</span><br /><span class="line"> 04h   WORD    size of stack control block array (should be 8*x)</span><br /><span class="line"> 06h   WORD    size of each stack (the y in STACKS=x,y)</span><br /><span class="line"> 08h   DWORD   pointer to STACKS data segment</span><br /><span class="line"> 0Ch   WORD    offset in STACKS data segment of stack control block array</span><br /><span class="line"> 0Eh   WORD    offset in STACKS data segment of last element of that array</span><br /><span class="line"> 10h   WORD    offset in STACKS data segment of the entry in that array for</span><br /><span class="line"></span><br /><span class="line"><span class="ngb">.NG limit reached, continued in next section...</span></span><br /></pre>
  
  
  


      </article>

    </section>

  </body>

</html>

