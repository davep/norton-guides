





<!DOCTYPE html>
<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="generator" content="ng2web v1.1.0 (ngdb v1.1.0)">
    <link rel="stylesheet" type="text/css" href="vista-style.css">
    <title>db_VISTA III » Functions » Functions descriptions</title>
    <meta name="description" content="db_VISTA III">
    
    
    
  </head>

  <body>

    <header>
      <nav class="box">
        <ul>
          

<li><a href="../index.html">Guides</a></li>


          

<li><a href="vista-about.html">About</a></li>


          

<li><span>Previous</span></li>


          

<li><a href="index.html">Up</a></li>


          

<li><span>Next</span></li>


        </ul>
      </nav>
    </header>

    <section>

      <nav class="menu box">
        <ul>
            <li>Functions</li>
            <ul>
              <li><a href="index.html">Functions descriptions</a></li>
              
            </ul>
            <li>Codes</li>
            <ul>
              <li><a href="vista-6446.html">Function status codes</a></li>
              <li><a href="vista-7989.html">System errors codes</a></li>
              <li><a href="vista-14319.html">User errors codes</a></li>
              <li><a href="vista-21058.html">Code&#39;s listing</a></li>
              
            </ul>
            <li>Credits</li>
            <ul>
              <li><a href="vista-22437.html">Credits</a></li>
              
            </ul>
        </ul>
      </nav>

      <article class="box">
        
  
  
    <pre class="entry"><span class="line">   D_OPEN</span><br /><span class="line"></span><br /><span class="line">SUMMARY</span><br /><span class="line">   d_open(dbnames,type)</span><br /><span class="line">   char *dbnames;</span><br /><span class="line">   char *type;</span><br /><span class="line"></span><br /><span class="line">ARGUMENTS</span><br /><span class="line">   dbnames      Semi-colon separated list off names of the databases to be</span><br /><span class="line">                opened.</span><br /><span class="line"></span><br /><span class="line">   type         String containing the type of access to the database.</span><br /><span class="line"></span><br /><span class="line">DESCRIPTION</span><br /><span class="line">   This function opens the databases identifed in the string pointed to be</span><br /><span class="line">   dbnames. If more than one database is to be opened, the names are</span><br /><span class="line">   separated in the list by semi-colons (&#39;;&#39;). No white space (i.e. space,</span><br /><span class="line">   tabs, ets.) should be embedded in the string. The type of access to all</span><br /><span class="line">   of the databases is specified by the string type as follows:</span><br /><span class="line"></span><br /><span class="line">   Type       Description</span><br /><span class="line"></span><br /><span class="line">   &#34;s&#34;        Shared access mode. Multiple can be accessing database at the</span><br /><span class="line">              same time</span><br /><span class="line"></span><br /><span class="line">   &#34;x&#34;        Exclusive access mode. Only one user can access the database.</span><br /><span class="line">              All others will be locked out.</span><br /><span class="line"></span><br /><span class="line">   &#34;o&#34;        One user only mode. Only one user will be using specified</span><br /><span class="line">              database.</span><br /><span class="line">──────────────────────────────────────────────────────────────────────────</span><br /><span class="line">Note:</span><br /><span class="line">   The single_user version of db_VISTA does not require the type parametr.</span><br /><span class="line">──────────────────────────────────────────────────────────────────────────</span><br /><span class="line">   Each database name can include a pach name of the directory which</span><br /><span class="line">   contains the dictionary and database files. Note that the specified pach</span><br /><span class="line">   will overide use of the DBDPACH and DBFPACH enviroment variables for that</span><br /><span class="line">   database.</span><br /><span class="line"></span><br /><span class="line">   If multiple databases are being opened, the databases are assigned</span><br /><span class="line">   sequentional numbers left to right in the order specified in the list with</span><br /><span class="line">   the first being zero. The current database will be set to zero (i.e. the</span><br /><span class="line">   first in the XXXX upon return from the call. The database number is either</span><br /><span class="line">   passed to function d_setbd or each database access function to set the</span><br /><span class="line">   current database when multiple databases have been opened.</span><br /><span class="line"></span><br /><span class="line">   db_VISTA&#39;s processing of a d_open call is quite involved and basically</span><br /><span class="line">   consist of dynamically allocating and initializing the memory required for</span><br /><span class="line">   the dictionary, currency tables, key processing tables, virtual memory</span><br /><span class="line">   cache, and lock control tables (in sharred mode). An inter-process</span><br /><span class="line">   communication sessions is initiated with the lock manager and the names of</span><br /><span class="line">   the database files to be used by the program are sent to lock manager.</span><br /><span class="line">   If there are no other databases open on the system, the transaction</span><br /><span class="line">   activity file is checked to see if recovery needs to be performed. The</span><br /><span class="line">   transaction log file is then initialized.</span><br /><span class="line"></span><br /><span class="line">CURRENCY CHANGES</span><br /><span class="line">   curr_rec = system record (or NULL_DBA, if no system record);</span><br /><span class="line"></span><br /><span class="line">   curr_own[system owned sets] = system record;</span><br /><span class="line"></span><br /><span class="line">   curr_own[all other sets] = NULL_DBA;</span><br /><span class="line"></span><br /><span class="line">   curr_mem[of all sets] = NULL_DBA;</span><br /><span class="line"></span><br /><span class="line">   curr_db = 0;</span><br /><span class="line"></span><br /><span class="line">RETURN CODES</span><br /><span class="line"></span><br /><span class="line">    5    S_UNAVAIL     Database is not availadle. Either another user has</span><br /><span class="line">                       exclusive access or your exclusive access request</span><br /><span class="line">                       cannot be satisfied because others are using the</span><br /><span class="line">                       database.</span><br /><span class="line"></span><br /><span class="line">    -4   S_INVDB       An invalid database name has been used or the database</span><br /><span class="line">                       could by found.</span><br /><span class="line"></span><br /><span class="line">    -11  S_BADTYPE     An invalid access mode type was specified. Be sure you</span><br /><span class="line">                       are passing string as opposed to single character.</span><br /><span class="line"></span><br /><span class="line">    -22  S_DELSYS      The current record is the system record.You are not</span><br /><span class="line">                       aloowed to delete the system record.</span><br /><span class="line"></span><br /><span class="line">    -34  S_USERID      No user id has been specified. You need to either have</span><br /><span class="line">                       the BDUSERID enviroment variable defined or you need</span><br /><span class="line">                       to call function d_dbuserid before d_open.</span><br /><span class="line"></span><br /><span class="line">    -35  S_NAMELEN     The fully qualified name of a control or database</span><br /><span class="line">                       file was longer that 47 characters.</span><br /><span class="line"></span><br /><span class="line">    -42  S_BADUSERID   The userid is invalid. it must contain only</span><br /><span class="line">                       alphanumeric characters or underscore (&#34;_&#34;).</span><br /><span class="line"></span><br /><span class="line"></span><br /><span class="line">    -43  S_NONETBIOS   There is no NetBIOS instaled on the machine.</span><br /><span class="line"></span><br /><span class="line">    -44  S_BADBDPACH   The number of elements in DBDPACH does not match the</span><br /><span class="line">                       number of databases opened.</span><br /><span class="line"></span><br /><span class="line">    -45  S_BADBFPACH   The number of elements in DBDPACH does not match the</span><br /><span class="line">                       number of databases opened.</span><br /><span class="line"></span><br /><span class="line">    -904 S_NOMEMORY    There is not enought available memory for all of the</span><br /><span class="line">                       required db_VISTA runtime tables. Try calling function</span><br /><span class="line">                       d_setpages with fewer pages before calling d_open.</span><br /><span class="line"></span><br /><span class="line">    -920 S_NOLOCKMGR   Unable to open lock manager session. The lock manager</span><br /><span class="line">                       has probably not been started.</span><br /><span class="line"></span><br /><span class="line">    -921 S_DUPUSERID   Specified user id is being used by another user.</span><br /><span class="line"></span><br /><span class="line">EXAMPLE</span><br /><span class="line"></span><br /><span class="line">    switch (operation)</span><br /><span class="line">     {</span><br /><span class="line">      case ACCTS_PAY:</span><br /><span class="line">          /* open for shared accounts payable usage*/</span><br /><span class="line">          d_open(&#34;genledg;acctspay&#34;,&#34;s&#34;);</span><br /><span class="line">          break;</span><br /><span class="line">      case ACCTS_RCV:</span><br /><span class="line">          /* open for shared accounts recievable usage*/</span><br /><span class="line">          d_open(&#34;genledg;acctsrcv&#34;,&#34;s&#34;);</span><br /><span class="line">          break;</span><br /><span class="line">      case MONTH_END:</span><br /><span class="line">          /* open for exclusive month-end processing*/</span><br /><span class="line">          d_open(&#34;genledg&#34;,&#34;x&#34;);</span><br /><span class="line">          break;</span><br /><span class="line">      }</span><br /><span class="line">    if (db_status == S_UNAVAIL)</span><br /><span class="line">      user_message(&#34;database unavailable&#34;)</span><br /><span class="line">    else if (db_status != S_OKAY)</span><br /><span class="line">            terminate();</span><br /><span class="line">    ......</span><br /></pre>
  
  
  
    <nav class="seeAlso">
      <ul>
        <li>See Also:</li>
        
          <li><a href="vista-23802.html">d_close</a></li>
        
          <li><a href="vista-141487.html">d_setdb</a></li>
        
      </ul>
    </nav>
  


      </article>

    </section>

  </body>

</html>

